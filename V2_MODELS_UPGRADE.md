# ‚úÖ –û–Ω–æ–≤–ª–µ–Ω–æ –¥–æ v2 –º–æ–¥–µ–ª–µ–π (fp16)

## üé® –©–æ –∑–º—ñ–Ω–∏–ª–æ—Å—å:

### –ú–æ–¥–µ–ª—ñ –≤ APK:

```
‚úÖ style_predict_v2.tflite    (4.7 MB) - fp16, –ö–†–ê–©–ê –Ø–ö–Ü–°–¢–¨
‚úÖ style_transfer_v2.tflite   (422 KB) - fp16, –ö–†–ê–©–ê –Ø–ö–Ü–°–¢–¨
‚úÖ style_predict.tflite       (2.8 MB) - int8, fallback
‚úÖ style_transfer.tflite      (284 KB) - int8, fallback
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –≤–∏–±—ñ—Ä –º–æ–¥–µ–ª—ñ:

```kotlin
// –°–ø—Ä–æ–±—É—î –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ v2 (fp16)
val predictModelPath = try {
    context.assets.openFd("models/style_predict_v2.tflite")
    "models/style_predict_v2.tflite"  // ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–∞—î v2
} catch (e: Exception) {
    "models/style_predict.tflite"     // Fallback –Ω–∞ v1
}
```

**–õ–æ–≥—ñ–∫–∞:**
1. –°–ø–æ—á–∞—Ç–∫—É —à—É–∫–∞—î v2 –º–æ–¥–µ–ª—ñ
2. –Ø–∫—â–æ –∑–Ω–∞–π–¥–µ–Ω–æ ‚Üí –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î v2 (fp16, –∫—Ä–∞—â–∞ —è–∫—ñ—Å—Ç—å)
3. –Ø–∫—â–æ –Ω—ñ ‚Üí fallback –Ω–∞ v1 (int8, –º–µ–Ω—à–∏–π —Ä–æ–∑–º—ñ—Ä)

## üìä –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è v1 vs v2:

### v2 (fp16) - –¢–ê –©–û –í–ò–ö–û–†–ò–°–¢–û–í–£–Ñ–¢–¨–°–Ø:
- ‚úÖ **Float16** —Ç–æ—á–Ω—ñ—Å—Ç—å
- ‚úÖ –ü–ª–∞–≤–Ω—ñ—à—ñ –≥—Ä–∞–¥—ñ—î–Ω—Ç–∏
- ‚úÖ –ú–µ–Ω—à–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ñ–≤
- ‚úÖ –¢–æ—á–Ω—ñ—à—ñ –∫–æ–ª—å–æ—Ä–∏
- ‚úÖ –ö—Ä–∞—â—ñ –¥–µ—Ç–∞–ª—ñ
- ‚ö†Ô∏è –ë—ñ–ª—å—à–∏–π —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—ñ–≤

### v1 (int8) - Fallback:
- ‚ö†Ô∏è **Integer8** —Ç–æ—á–Ω—ñ—Å—Ç—å
- ‚ö†Ô∏è –ú–æ–∂–ª–∏–≤—ñ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∏
- ‚ö†Ô∏è –ë–∞–Ω–¥—ñ–Ω–≥ –Ω–∞ –≥—Ä–∞–¥—ñ—î–Ω—Ç–∞—Ö
- ‚úÖ –ú–µ–Ω—à–∏–π —Ä–æ–∑–º—ñ—Ä
- ‚úÖ –¢—Ä–æ—Ö–∏ —à–≤–∏–¥—à–µ

## üöÄ –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó (–∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è):

1. **XNNPACK** - CPU –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è (2-3x —à–≤–∏–¥—à–µ)
2. **–ë–∞–≥–∞—Ç–æ–ø–æ—Ç–æ—á–Ω—ñ—Å—Ç—å** - –≤—Å—ñ —è–¥—Ä–∞ –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞
3. **–ö—Ä–∞—â–∞ –¥–µ–Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è** - –ø—Ä–∞–≤–∏–ª—å–Ω–µ –æ–∫—Ä—É–≥–ª–µ–Ω–Ω—è
4. **–û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø–∞–º'—è—Ç—ñ** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–≤—ñ–ª—å–Ω–µ–Ω–Ω—è

## üì± –û—á—ñ–∫—É–≤–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏:

### –Ø–∫—ñ—Å—Ç—å (v2 fp16):
- üé® **–ó–Ω–∞—á–Ω–æ –∫—Ä–∞—â–∞** –Ω—ñ–∂ v1
- üé® –ü–ª–∞–≤–Ω—ñ –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫–æ–ª—å–æ—Ä—ñ–≤
- üé® –ú–µ–Ω—à–µ "–±–ª–æ—á–Ω–æ—Å—Ç—ñ"
- üé® –¢–æ—á–Ω—ñ—à—ñ –¥–µ—Ç–∞–ª—ñ —Å—Ç–∏–ª—é
- üé® –ü—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∞ —è–∫—ñ—Å—Ç—å

### –®–≤–∏–¥–∫—ñ—Å—Ç—å:
- ‚ö° XNNPACK: 2-3x —à–≤–∏–¥—à–µ –±–∞–∑–æ–≤–æ–≥–æ CPU
- ‚ö° v2 –º–æ–∂–µ –±—É—Ç–∏ —Ç—Ä–æ—Ö–∏ –ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ –Ω—ñ–∂ v1
- ‚ö° –ê–ª–µ —Ä—ñ–∑–Ω–∏—Ü—è –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –∑–∞–≤–¥—è–∫–∏ XNNPACK

### –†–æ–∑–º—ñ—Ä APK:
- üì¶ +2 MB —á–µ—Ä–µ–∑ v2 –º–æ–¥–µ–ª—ñ
- üì¶ –ê–ª–µ –æ–±–∏–¥–≤—ñ –≤–µ—Ä—Å—ñ—ó –≤ APK (fallback)
- üì¶ –ú–æ–∂–Ω–∞ –≤–∏–¥–∞–ª–∏—Ç–∏ v1 —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ

## üîç –õ–æ–≥–∏ (—â–æ –ø–æ–±–∞—á–∏—à):

### –£—Å–ø—ñ—à–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è v2:
```
D/StyleTransfer: Loading style_predict model...
D/StyleTransfer: Using v2 prediction model ‚úÖ
D/StyleTransfer: style_predict model loaded successfully
D/StyleTransfer: Loading style_transfer model...
D/StyleTransfer: Using v2 transfer model ‚úÖ
D/StyleTransfer: style_transfer model loaded successfully
```

### Fallback –Ω–∞ v1 (—è–∫—â–æ v2 –Ω–µ–º–∞—î):
```
D/StyleTransfer: v2 not found, using v1 prediction model
D/StyleTransfer: v2 not found, using v1 transfer model
```

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:

### –î–ª—è –Ω–∞–π–∫—Ä–∞—â–æ—ó —è–∫–æ—Å—Ç—ñ:
1. ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π v2 –º–æ–¥–µ–ª—ñ (–≤–∂–µ —î –≤ APK)
2. ‚úÖ –Ø–∫—ñ—Å–Ω—ñ style images (512x512+)
3. ‚úÖ –î–æ–±—Ä–µ –æ—Å–≤—ñ—Ç–ª–µ–Ω—ñ —Ñ–æ—Ç–æ
4. ‚úÖ –ß—ñ—Ç–∫—ñ –¥–µ—Ç–∞–ª—ñ

### –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å:
- –ú–æ–∂–Ω–∞ –≤–∏–¥–∞–ª–∏—Ç–∏ v2 –º–æ–¥–µ–ª—ñ
- –ó–∞–ª–∏—à–∏—Ç–∏ —Ç—ñ–ª—å–∫–∏ v1 (int8)
- –ê–ª–µ —è–∫—ñ—Å—Ç—å –±—É–¥–µ –≥—ñ—Ä—à–∞

### –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω –º–µ–Ω—à–∏–π APK:
- –í–∏–¥–∞–ª–∏ v1 –º–æ–¥–µ–ª—ñ (fallback)
- –ó–∞–ª–∏—à —Ç—ñ–ª—å–∫–∏ v2
- –ï–∫–æ–Ω–æ–º—ñ—è ~3 MB

## üéØ –ü—ñ–¥—Å—É–º–æ–∫:

**–ó–∞—Ä–∞–∑ –¥–æ–¥–∞—Ç–æ–∫:**
- ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î v2 (fp16) –¥–ª—è –Ω–∞–π–∫—Ä–∞—â–æ—ó —è–∫–æ—Å—Ç—ñ
- ‚úÖ –ú–∞—î v1 (int8) —è–∫ fallback
- ‚úÖ XNNPACK –¥–ª—è —à–≤–∏–¥–∫–æ—Å—Ç—ñ
- ‚úÖ –û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∏–π –¥–ª—è —è–∫–æ—Å—Ç—ñ —Ç–∞ —à–≤–∏–¥–∫–æ—Å—Ç—ñ
- ‚úÖ –ù–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î GPU (—Å—Ç–∞–±—ñ–ª—å–Ω–æ)

**–í—Å—Ç–∞–Ω–æ–≤–∏ –Ω–æ–≤–∏–π APK —ñ –Ω–∞—Å–æ–ª–æ–¥–∂—É–π—Å—è –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω–æ—é —è–∫—ñ—Å—Ç—é AI Style Transfer!** üé®‚ú®

## üìù –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ:

### v2 Prediction Model (fp16):
- Size: 4.7 MB
- Precision: Float16
- Input: [1, 256, 256, 3]
- Output: [1, 1, 1, 100]

### v2 Transfer Model (fp16):
- Size: 422 KB
- Precision: Float16
- Input 1: [1, 384, 384, 3] (content)
- Input 2: [1, 1, 1, 100] (style)
- Output: [1, 384, 384, 3] (result)

### –ü–µ—Ä–µ–≤–∞–≥–∏ fp16:
- 16-bit floating point
- –î—ñ–∞–ø–∞–∑–æ–Ω: ¬±65,504
- –¢–æ—á–Ω—ñ—Å—Ç—å: ~3 decimal digits
- –Ü–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –Ω–µ–π—Ä–æ–Ω–Ω–∏—Ö –º–µ—Ä–µ–∂
- –ë–∞–ª–∞–Ω—Å —è–∫—ñ—Å—Ç—å/—Ä–æ–∑–º—ñ—Ä
