# ‚ö†Ô∏è –û–±–º–µ–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ Magenta v2

## üîç –ü—Ä–æ–±–ª–µ–º–∞:

**–ú–æ–¥–µ–ª—å v2 (fp16) –ø—ñ–¥—Ç—Ä–∏–º—É—î –¢–Ü–õ–¨–ö–ò 384x384!**

```
Transfer input[0] shape: [1, 384, 384, 3]  ‚Üê –§—ñ–∫—Å–æ–≤–∞–Ω–∏–π —Ä–æ–∑–º—ñ—Ä!
```

## ‚ùå –©–æ –ù–ï –ø—Ä–∞—Ü—é—î:

### –°–ø—Ä–æ–±–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ 512x512:
```
Content buffer: 3145728 bytes (512*512*3*4)
Model expects: 1769472 bytes (384*384*3*4)
Result: IllegalArgumentException ‚ùå
```

## ‚úÖ –©–æ –ø—Ä–∞—Ü—é—î:

### –¢—ñ–ª—å–∫–∏ 384x384:
```kotlin
private val contentImageSize = 384  // –§—ñ–∫—Å–æ–≤–∞–Ω–æ!
```

## üìä –ß–æ–º—É —è–∫—ñ—Å—Ç—å –Ω–µ —ñ–¥–µ–∞–ª—å–Ω–∞:

### –û–±–º–µ–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ:
1. **384x384 = 147,456 –ø—ñ–∫—Å–µ–ª—ñ–≤** (–Ω–µ –¥—É–∂–µ –±–∞–≥–∞—Ç–æ)
2. **–í—Ç—Ä–∞—Ç–∞ –¥–µ—Ç–∞–ª–µ–π** –ø—Ä–∏ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—ñ –≤–µ–ª–∏–∫–∏—Ö —Ñ–æ—Ç–æ
3. **–ê—Ä—Ç–µ—Ñ–∞–∫—Ç–∏** –ø—Ä–∏ –∞–ø—Å–∫–µ–π–ª—ñ –Ω–∞–∑–∞–¥
4. **–¶–µ –æ–±–º–µ–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ**, –Ω–µ –∫–æ–¥—É!

### –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è:
- **–í—Ö—ñ–¥–Ω–µ —Ñ–æ—Ç–æ**: 1920x1080 = 2,073,600 –ø—ñ–∫—Å–µ–ª—ñ–≤
- **–û–±—Ä–æ–±–∫–∞**: 384x384 = 147,456 –ø—ñ–∫—Å–µ–ª—ñ–≤ (-93%!)
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: 1920x1080 (–∞–ø—Å–∫–µ–π–ª –∑ –≤—Ç—Ä–∞—Ç–∞–º–∏)

## üí° –©–æ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏:

### 1. **–ü–æ–∫—Ä–∞—â–∏—Ç–∏ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è** ‚úÖ (–≤–∂–µ –∑—Ä–æ–±–ª–µ–Ω–æ)
```kotlin
createHighQualityScaledBitmap():
- AntiAlias
- FilterBitmap  
- Dither
```

### 2. **–í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ v2 fp16** ‚úÖ (–≤–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è)
- –ö—Ä–∞—â–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å –Ω—ñ–∂ int8
- –ú–µ–Ω—à–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ñ–≤
- –ü–ª–∞–≤–Ω—ñ—à—ñ –≥—Ä–∞–¥—ñ—î–Ω—Ç–∏

### 3. **XNNPACK –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è** ‚úÖ (–≤–∂–µ —î)
- –®–≤–∏–¥—à–µ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è
- –ö—Ä–∞—â–∞ —è–∫—ñ—Å—Ç—å

### 4. **–©–æ –ù–ï –º–æ–∂–Ω–∞:**
- ‚ùå –ó–±—ñ–ª—å—à–∏—Ç–∏ —Ä–æ–∑–º—ñ—Ä –æ–±—Ä–æ–±–∫–∏ (–º–æ–¥–µ–ª—å –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î)
- ‚ùå –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ GPU (–∫—Ä–∞—à–∏—Ç—å—Å—è)
- ‚ùå –ó–º—ñ–Ω–∏—Ç–∏ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É –º–æ–¥–µ–ª—ñ

## üéØ –†–µ–∞–ª—ñ—Å—Ç–∏—á–Ω—ñ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è:

### –©–æ –º–æ–¥–µ–ª—å —Ä–æ–±–∏—Ç—å –¥–æ–±—Ä–µ:
- ‚úÖ –ó–∞—Å—Ç–æ—Å–æ–≤—É—î —Å—Ç–∏–ª—å
- ‚úÖ –ó–±–µ—Ä—ñ–≥–∞—î –∫–æ–º–ø–æ–∑–∏—Ü—ñ—é
- ‚úÖ –ü—Ä–∞—Ü—é—î —à–≤–∏–¥–∫–æ
- ‚úÖ –ù–µ –∫—Ä–∞—à–∏—Ç—å—Å—è

### –©–æ –º–æ–¥–µ–ª—å —Ä–æ–±–∏—Ç—å –Ω–µ —ñ–¥–µ–∞–ª—å–Ω–æ:
- ‚ö†Ô∏è –í—Ç—Ä–∞—Ç–∞ –¥—Ä—ñ–±–Ω–∏—Ö –¥–µ—Ç–∞–ª–µ–π
- ‚ö†Ô∏è –ê—Ä—Ç–µ—Ñ–∞–∫—Ç–∏ –Ω–∞ –≤–µ–ª–∏–∫–∏—Ö —Ñ–æ—Ç–æ
- ‚ö†Ô∏è "–ë–ª–æ—á–Ω—ñ—Å—Ç—å" –Ω–∞ –≥—Ä–∞–¥—ñ—î–Ω—Ç–∞—Ö
- ‚ö†Ô∏è –†–æ–∑–º–∏—Ç—ñ –∫—Ä–∞—ó

## üîÑ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∏:

### –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–∞ –∫—Ä–∞—â–∞ —è–∫—ñ—Å—Ç—å:

#### 1. **–Ü–Ω—à—ñ –º–æ–¥–µ–ª—ñ:**
- **Arbitrary Style Transfer v2** (640x640) - –∞–ª–µ –≤–∞–∂–∫–æ –∑–Ω–∞–π—Ç–∏
- **Neural Style Transfer** - –ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ, –∞–ª–µ –∫—Ä–∞—â–µ
- **Custom models** - —Ç—Ä–µ–±–∞ —Ç—Ä–µ–Ω—É–≤–∞—Ç–∏

#### 2. **–°–µ—Ä–≤–µ—Ä–Ω–∞ –æ–±—Ä–æ–±–∫–∞:**
- –í—ñ–¥–ø—Ä–∞–≤–ª—è—Ç–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø–æ—Ç—É–∂–Ω—ñ—à—ñ –º–æ–¥–µ–ª—ñ
- –û–±—Ä–æ–±–∫–∞ –≤ –ø–æ–≤–Ω–æ–º—É —Ä–æ–∑–º—ñ—Ä—ñ
- –ê–ª–µ –ø–æ—Ç—Ä—ñ–±–µ–Ω —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç

#### 3. **–ì—ñ–±—Ä–∏–¥–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥:**
- –õ–æ–∫–∞–ª—å–Ω–∏–π preview (384x384)
- –°–µ—Ä–≤–µ—Ä–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –¥–ª—è —Ñ—ñ–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
- –ù–∞–π–∫—Ä–∞—â–∞ —è–∫—ñ—Å—Ç—å + —à–≤–∏–¥–∫–∏–π preview

## üì± –ü–æ—Ç–æ—á–Ω–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è:

```kotlin
// –ú–∞–∫—Å–∏–º—É–º —â–æ –ø—ñ–¥—Ç—Ä–∏–º—É—î –º–æ–¥–µ–ª—å
private val styleImageSize = 256   // Style prediction
private val contentImageSize = 384 // Style transfer

// –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è —è–∫–æ—Å—Ç—ñ
- v2 fp16 models ‚úÖ
- XNNPACK delegate ‚úÖ
- High-quality scaling ‚úÖ
- Proper denormalization ‚úÖ
```

## üí≠ –í–∏—Å–Ω–æ–≤–æ–∫:

**384x384 - —Ü–µ –æ–±–º–µ–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ Magenta v2.**

–î–ª—è –∫—Ä–∞—â–æ—ó —è–∫–æ—Å—Ç—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ:
1. –Ü–Ω—à–∞ –º–æ–¥–µ–ª—å (640x640 –∞–±–æ –±—ñ–ª—å—à–µ)
2. –°–µ—Ä–≤–µ—Ä–Ω–∞ –æ–±—Ä–æ–±–∫–∞
3. –ê–±–æ –∑–º–∏—Ä–∏—Ç–∏—Å—å –∑ –ø–æ—Ç–æ—á–Ω–æ—é —è–∫—ñ—Å—Ç—é

**–ü–æ—Ç–æ—á–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è - —Ü–µ –º–∞–∫—Å–∏–º—É–º —â–æ –º–æ–∂–Ω–∞ –≤–∏—Ç—è–≥–Ω—É—Ç–∏ –∑ Magenta v2 –Ω–∞ –ø—Ä–∏—Å—Ç—Ä–æ—ó!** üé®

## üé® –ü–æ—Ä–∞–¥–∏ –¥–ª—è –Ω–∞–π–∫—Ä–∞—â–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É:

### –ó –ø–æ—Ç–æ—á–Ω–æ—é –º–æ–¥–µ–ª–ª—é:

1. **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π —è–∫—ñ—Å–Ω—ñ style images:**
   - –ú—ñ–Ω—ñ–º—É–º 512x512
   - –ß—ñ—Ç–∫—ñ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Å—Ç–∏–ª—é
   - –ù–µ —Å—Ç–∏—Å–Ω—É—Ç—ñ JPEG

2. **–í—Ö—ñ–¥–Ω—ñ —Ñ–æ—Ç–æ:**
   - –ù–µ –¥—É–∂–µ –≤–µ–ª–∏–∫—ñ (–¥–æ 2000px)
   - –î–æ–±—Ä–µ –æ—Å–≤—ñ—Ç–ª–µ–Ω—ñ
   - –ß—ñ—Ç–∫—ñ –¥–µ—Ç–∞–ª—ñ

3. **–û—á—ñ–∫—É–≤–∞–Ω–Ω—è:**
   - –¶–µ —Ö—É–¥–æ–∂–Ω—ñ–π –µ—Ñ–µ–∫—Ç, –Ω–µ —Ñ–æ—Ç–æ—Ä–µ–∞–ª—ñ–∑–º
   - –î–µ—Ç–∞–ª—ñ –º–æ–∂—É—Ç—å –≤—Ç—Ä–∞—á–∞—Ç–∏—Å—å
   - –ê–ª–µ –∑–∞–≥–∞–ª—å–Ω–∏–π —Å—Ç–∏–ª—å –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è

### –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–∞ –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∞ —è–∫—ñ—Å—Ç—å:
- –†–æ–∑–≥–ª—è–Ω—å —Å–µ—Ä–≤–µ—Ä–Ω—É –æ–±—Ä–æ–±–∫—É
- –ê–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π desktop –¥–æ–¥–∞—Ç–∫–∏
- –ú–æ–±—ñ–ª—å–Ω—ñ –º–æ–¥–µ–ª—ñ –º–∞—é—Ç—å –æ–±–º–µ–∂–µ–Ω–Ω—è

## ‚úÖ –ü—ñ–¥—Å—É–º–æ–∫:

**–ó–∞—Ä–∞–∑ –¥–æ–¥–∞—Ç–æ–∫:**
- ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –Ω–∞–π–∫—Ä–∞—â—É –¥–æ—Å—Ç—É–ø–Ω—É –º–æ–¥–µ–ª—å (v2 fp16)
- ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ñ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó (XNNPACK, scaling)
- ‚úÖ –°—Ç–∞–±—ñ–ª—å–Ω–æ –ø—Ä–∞—Ü—é—î
- ‚ö†Ô∏è –û–±–º–µ–∂–µ–Ω–∏–π 384x384 (–º–æ–¥–µ–ª—å)

**–¶–µ –º–∞–∫—Å–∏–º—É–º —è–∫–æ—Å—Ç—ñ –¥–ª—è on-device –æ–±—Ä–æ–±–∫–∏ –∑ Magenta!** üöÄ
