# AI Style Transfer - –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è —è–∫–æ—Å—Ç—ñ

## ‚úÖ –©–æ –±—É–ª–æ –ø–æ–∫—Ä–∞—â–µ–Ω–æ:

### 1. **XNNPACK Delegate** üöÄ
```kotlin
setUseXNNPACK(true)
```
- **–©–æ —Ü–µ**: –û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∏–π CPU backend –≤—ñ–¥ Google
- **–ü–µ—Ä–µ–≤–∞–≥–∏**: 
  - –®–≤–∏–¥—à–µ –Ω–∞ 2-3x –ø–æ—Ä—ñ–≤–Ω—è–Ω–æ –∑—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–º TFLite
  - –ö—Ä–∞—â–∞ —è–∫—ñ—Å—Ç—å –æ–±—á–∏—Å–ª–µ–Ω—å
  - –°—Ç–∞–±—ñ–ª—å–Ω—ñ—à–µ –Ω—ñ–∂ GPU (–Ω–µ –∫—Ä–∞—à–∏—Ç—å—Å—è)
  - –ü—Ä–∞—Ü—é—î –Ω–∞ –≤—Å—ñ—Ö –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö

### 2. **–î–∏–Ω–∞–º—ñ—á–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—Ç–æ–∫—ñ–≤** üîß
```kotlin
setNumThreads(Runtime.getRuntime().availableProcessors())
```
- **–ë—É–ª–æ**: 4 –ø–æ—Ç–æ–∫–∏ (—Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ)
- **–°—Ç–∞–ª–æ**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≤—Å—ñ –¥–æ—Å—Ç—É–ø–Ω—ñ —è–¥—Ä–∞ –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –®–≤–∏–¥—à–µ –Ω–∞ –±–∞–≥–∞—Ç–æ—è–¥–µ—Ä–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö

### 3. **–ü–æ–∫—Ä–∞—â–µ–Ω–∞ –¥–µ–Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è** üé®
```kotlin
val r = (floatArray[y][x][0].coerceIn(0f, 1f) * 255f + 0.5f).toInt()
```
- **–ë—É–ª–æ**: `(value * 255).toInt()` - –æ–±—Ä—ñ–∑–∞–Ω–Ω—è
- **–°—Ç–∞–ª–æ**: 
  - `coerceIn(0f, 1f)` - –æ–±–º–µ–∂–µ–Ω–Ω—è –¥—ñ–∞–ø–∞–∑–æ–Ω—É
  - `+ 0.5f` - –ø—Ä–∞–≤–∏–ª—å–Ω–µ –æ–∫—Ä—É–≥–ª–µ–Ω–Ω—è (banker's rounding)
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ú–µ–Ω—à–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ñ–≤, –ø–ª–∞–≤–Ω—ñ—à—ñ –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫–æ–ª—å–æ—Ä—ñ–≤

### 4. **–û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø–∞–º'—è—Ç—ñ** üíæ
```kotlin
return Bitmap.createScaledBitmap(...).also {
    if (it != bitmap) bitmap.recycle()
}
```
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–≤—ñ–ª—å–Ω–µ–Ω–Ω—è —Ç–∏–º—á–∞—Å–æ–≤–∏—Ö bitmap
- –ú–µ–Ω—à–µ –≤–∏—Ç–æ–∫—ñ–≤ –ø–∞–º'—è—Ç—ñ
- –®–≤–∏–¥—à–∞ —Ä–æ–±–æ—Ç–∞ –Ω–∞ –¥–æ–≤–≥–∏—Ö —Å–µ—Å—ñ—è—Ö

### 5. **–ö—Ä–∞—â–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è style images** üñºÔ∏è
```kotlin
val options = BitmapFactory.Options().apply {
    inPreferredConfig = Bitmap.Config.ARGB_8888
}
```
- –§–æ—Ä—Å—É—î–º–æ ARGB_8888 –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—ó —è–∫–æ—Å—Ç—ñ
- –£–Ω–∏–∫–∞—î–º–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ—ó –∫–æ–º–ø—Ä–µ—Å—ñ—ó

### 6. **–£–º–æ–≤–Ω–µ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è** üìê
```kotlin
val resultBitmap = if (outputBitmap.width != bitmap.width || ...) {
    Bitmap.createScaledBitmap(...)
} else {
    outputBitmap
}
```
- –ú–∞—Å—à—Ç–∞–±—É—î–º–æ —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ
- –ó–±–µ—Ä—ñ–≥–∞—î —è–∫—ñ—Å—Ç—å —è–∫—â–æ —Ä–æ–∑–º—ñ—Ä–∏ —Å–ø—ñ–≤–ø–∞–¥–∞—é—Ç—å

## üìä –û—á—ñ–∫—É–≤–∞–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è:

### –®–≤–∏–¥–∫—ñ—Å—Ç—å:
- **XNNPACK**: +100-200% —à–≤–∏–¥—à–µ
- **–ë–∞–≥–∞—Ç–æ–ø–æ—Ç–æ—á–Ω—ñ—Å—Ç—å**: +20-50% –Ω–∞ —Å—É—á–∞—Å–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö
- **–ó–∞–≥–∞–ª–æ–º**: 2-3x —à–≤–∏–¥—à–µ –Ω—ñ–∂ –±—É–ª–æ

### –Ø–∫—ñ—Å—Ç—å:
- ‚úÖ –ú–µ–Ω—à–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ñ–≤ –Ω–∞ –∫—Ä–∞—è—Ö
- ‚úÖ –ü–ª–∞–≤–Ω—ñ—à—ñ –≥—Ä–∞–¥—ñ—î–Ω—Ç–∏
- ‚úÖ –¢–æ—á–Ω—ñ—à—ñ –∫–æ–ª—å–æ—Ä–∏
- ‚úÖ –ú–µ–Ω—à–µ "–±–ª–æ—á–Ω–æ—Å—Ç—ñ"

### –°—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å:
- ‚úÖ –ù–µ –∫—Ä–∞—à–∏—Ç—å—Å—è (–±–µ–∑ GPU)
- ‚úÖ –ü—Ä–∞—Ü—é—î –Ω–∞ –≤—Å—ñ—Ö Android –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö
- ‚úÖ –ú–µ–Ω—à–µ –≤–∏—Ç–æ–∫—ñ–≤ –ø–∞–º'—è—Ç—ñ

## üéØ –†–æ–∑–º—ñ—Ä–∏ –∑–∞–ª–∏—à–∏–ª–∏—Å—å:

- **Style image**: 256x256 (–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è –º–æ–¥–µ–ª—ñ)
- **Content image**: 384x384 (–±–∞–ª–∞–Ω—Å —è–∫—ñ—Å—Ç—å/—à–≤–∏–¥–∫—ñ—Å—Ç—å)
- **Output**: –ú–∞—Å—à—Ç–∞–±—É—î—Ç—å—Å—è –¥–æ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–æ–∑–º—ñ—Ä—É

## üîç –Ø–∫—â–æ —è–∫—ñ—Å—Ç—å –≤—Å–µ —â–µ –Ω–µ —ñ–¥–µ–∞–ª—å–Ω–∞:

### –ú–æ–∂–ª–∏–≤—ñ –ø—Ä–∏—á–∏–Ω–∏:

1. **Style images –Ω–∏–∑—å–∫–æ—ó —è–∫–æ—Å—Ç—ñ**
   - –ü–µ—Ä–µ–≤—ñ—Ä —â–æ style images –≤–∏—Å–æ–∫–æ—ó —Ä–æ–∑–¥—ñ–ª—å–Ω–æ—Å—Ç—ñ
   - –ú–∞—é—Ç—å —á—ñ—Ç–∫—ñ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Å—Ç–∏–ª—é
   - –ù–µ —Å—Ç–∏—Å–Ω—É—Ç—ñ JPEG –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞–º–∏

2. **–ú–æ–¥–µ–ª—å –Ω–µ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å**
   - –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è —â–æ —Ü–µ Magenta v1-256
   - –ù–µ v2, –Ω–µ —ñ–Ω—à–∞ –≤–µ—Ä—Å—ñ—è
   - –ó–∞–≤–∞–Ω—Ç–∞–∂ –∑ –æ—Ñ—ñ—Ü—ñ–π–Ω–æ–≥–æ –¥–∂–µ—Ä–µ–ª–∞

3. **–í—Ö—ñ–¥–Ω–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è**
   - –î—É–∂–µ –≤–µ–ª–∏–∫–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è ‚Üí –±—ñ–ª—å—à–µ –≤—Ç—Ä–∞—Ç –ø—Ä–∏ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—ñ
   - –î—É–∂–µ –º–∞–ª–µ ‚Üí –ø–æ–≥–∞–Ω–∞ —è–∫—ñ—Å—Ç—å –ø—ñ—Å–ª—è –∞–ø—Å–∫–µ–π–ª—É

### –î–æ–¥–∞—Ç–∫–æ–≤—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ):

**–Ø–∫—â–æ —Ö–æ—á–µ—à —â–µ –∫—Ä–∞—â—É —è–∫—ñ—Å—Ç—å (–∞–ª–µ –ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ):**
```kotlin
// –ú–æ–∂–Ω–∞ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–±—ñ–ª—å—à–∏—Ç–∏ –¥–æ 512, –∞–ª–µ –º–æ–∂–µ –∫—Ä–∞—à–∏—Ç–∏—Å—å
private val contentImageSize = 512  // –û–ë–ï–†–ï–ñ–ù–û!
```

**–Ø–∫—â–æ —Ö–æ—á–µ—à —à–≤–∏–¥—à–µ (–∞–ª–µ –≥—ñ—Ä—à–∞ —è–∫—ñ—Å—Ç—å):**
```kotlin
private val contentImageSize = 256  // –®–≤–∏–¥—à–µ, –∞–ª–µ –º–µ–Ω—à –¥–µ—Ç–∞–ª—ñ–∑–æ–≤–∞–Ω–æ
```

## üì± –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è:

1. –í—Å—Ç–∞–Ω–æ–≤–∏ –Ω–æ–≤–∏–π APK
2. –°–ø—Ä–æ–±—É–π —Ä—ñ–∑–Ω—ñ —Å—Ç–∏–ª—ñ
3. –ü–æ—Ä—ñ–≤–Ω—è–π –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—é –≤–µ—Ä—Å—ñ—î—é
4. –Ø–∫—ñ—Å—Ç—å –º–∞—î –±—É—Ç–∏ –ø–æ–º—ñ—Ç–Ω–æ –∫—Ä–∞—â–∞!

## üé® –ü–æ—Ä–∞–¥–∏ –¥–ª—è –Ω–∞–π–∫—Ä–∞—â–æ—ó —è–∫–æ—Å—Ç—ñ:

1. **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π —è–∫—ñ—Å–Ω—ñ style images**:
   - –ú—ñ–Ω—ñ–º—É–º 512x512 –ø—ñ–∫—Å–µ–ª—ñ–≤
   - –ß—ñ—Ç–∫—ñ, –Ω–µ —Ä–æ–∑–º–∏—Ç—ñ
   - –Ø—Å–∫—Ä–∞–≤—ñ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Å—Ç–∏–ª—é

2. **–í—Ö—ñ–¥–Ω—ñ —Ñ–æ—Ç–æ**:
   - –ù–µ –¥—É–∂–µ —Ç–µ–º–Ω—ñ
   - –î–æ–±—Ä–µ –æ—Å–≤—ñ—Ç–ª–µ–Ω—ñ
   - –ß—ñ—Ç–∫—ñ –¥–µ—Ç–∞–ª—ñ

3. **–°—Ç–∏–ª—ñ –ø—Ä–∞—Ü—é—é—Ç—å –∫—Ä–∞—â–µ –Ω–∞**:
   - –ü–æ—Ä—Ç—Ä–µ—Ç–∞—Ö (Van Gogh, Oil Painting)
   - –ü–µ–π–∑–∞–∂–∞—Ö (Impressionism, Watercolor)
   - –û–±'—î–∫—Ç–∞—Ö (Pop Art, Cartoon)

–Ø–∫—â–æ –ø—ñ—Å–ª—è —Ü–∏—Ö –ø–æ–∫—Ä–∞—â–µ–Ω—å —è–∫—ñ—Å—Ç—å –≤—Å–µ —â–µ –Ω–µ –∑–∞–¥–æ–≤–æ–ª—å–Ω—è—î - —Å–∫–∞–∂–∏ —è–∫—ñ —Å–∞–º–µ –ø—Ä–æ–±–ª–µ–º–∏ –±–∞—á–∏—à (–∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∏, –∫–æ–ª—å–æ—Ä–∏, –¥–µ—Ç–∞–ª—ñ)!
